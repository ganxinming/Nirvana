<img src="../../Library/Application Support/typora-user-images/image-20220709214626479.png" alt="image-20220709214626479" style="zoom:33%;" />

# 微服务架构

微服务架构在某种程度上是面向服务的架构SOA继续发展的下一步，它更加强调服务的"彻底拆分"。

**优点**：

服务原子化拆分，独立打包、部署和升级，保证每个微服务清晰的任务划分，利于扩展

微服务之间采用Restful等轻量级http协议相互调用

**缺点**：

分布式系统开发的技术成本高（容错、分布式事务等）

# 微服务架构的常见问题

一旦采用微服务系统架构，就势必会遇到这样几个问题：

这么多小服务，如何管理他们？(服务治理 注册中心[服务注册 发现 剔除])

这么多小服务，他们之间如何通讯？(**restful** rpc)

这么多小服务，客户端怎么访问他们？(网关)

这么多小服务，一旦出现问题了，应该如何自处理？(容错)

这么多小服务，一旦出现问题了，应该如何排错? (链路追踪)

# 微服务架构的常见概念

**服务治理：**服务治理就是进行服务的自动化管理，其核心是服务的自动注册与发现。

**服务注册**：服务实例将自身服务信息注册到注册中心。

**服务发现**：服务实例通过注册中心，获取到注册到其中的服务实例的信息，通过这些信息去请求它们提

供的服务。

**服务剔除**：服务注册中心将出问题的服务自动剔除到可用列表之外，使其不会被调用到。

#### **服务调用**：

在微服务架构中，通常存在多个服务之间的远程调用的需求。目前主流的远程调用技术有基于HTTP的RESTful接口以及基于TCP的RPC协议。

**REST**(Representational State Transfer)

这是一种HTTP调用的格式，更标准，更通用，无论哪种语言都支持http协议

**RPC**（Remote Promote Call）

一种进程间通信方式。允许像调用本地服务一样调用远程服务。RPC框架的主要目标就是让远程服务调用更简单、透明。RPC框架负责屏蔽底层的传输方式、序列化方式和通信细节。开发人员在使用的时候只需要了解谁在什么位置提供了什么样的远程服务接口即可，并不需要关心底层通信细节和调用过程。

#### **服务网关**：

随着微服务的不断增多，不同的微服务一般会有不同的网络地址，而外部客户端可能需要调用多个服务的接口才能完成一个业务需求，如果让客户端直接与各个微服务通信可能出现：客户端需要调用不同的url地址，增加难度。在一定的场景下，存在跨域请求的问题。每个微服务都需要进行单独的身份认证针对这些问题，API网关顺势而生。

API网关直面意思是将所有API调用统一接入到API网关层，由网关层统一接入和输出。一个网关的基本功能有：统一接入、安全防护、协议适配、流量管控、长短链接支持、容错能力。有了网关之后，各个API服务提供团队可以专注于自己的的业务逻辑处理，而API网关更专注于安全、流量、路由等问题。